!function(t){var e,n,i;!function(t){function r(t,e){return _.call(t,e)}function o(t,e){var n,i,r,o,s,u,c,f,l,a,p,h,d=e&&e.split("/"),y=m.map,v=y&&y["*"]||{};if(t){for(t=t.split("/"),s=t.length-1,m.nodeIdCompat&&j.test(t[s])&&(t[s]=t[s].replace(j,"")),"."===t[0].charAt(0)&&d&&(h=d.slice(0,d.length-1),t=h.concat(t)),l=0;l<t.length;l++)if("."===(p=t[l]))t.splice(l,1),l-=1;else if(".."===p){if(0===l||1===l&&".."===t[2]||".."===t[l-1])continue;l>0&&(t.splice(l-1,2),l-=2)}t=t.join("/")}if((d||v)&&y){for(n=t.split("/"),l=n.length;l>0;l-=1){if(i=n.slice(0,l).join("/"),d)for(a=d.length;a>0;a-=1)if((r=y[d.slice(0,a).join("/")])&&(r=r[i])){o=r,u=l;break}if(o)break;!c&&v&&v[i]&&(c=v[i],f=l)}!o&&c&&(o=c,u=f),o&&(n.splice(0,u,o),t=n.join("/"))}return t}function s(e,n){return function(){var i=O.call(arguments,0);return"string"!=typeof i[0]&&1===i.length&&i.push(null),d.apply(t,i.concat([e,n]))}}function u(t){return function(e){return o(e,t)}}function c(t){return function(e){b[t]=e}}function f(e){if(r(w,e)){var n=w[e];delete w[e],g[e]=!0,h.apply(t,n)}if(!r(b,e)&&!r(g,e))throw new Error("No "+e);return b[e]}function l(t){var e,n=t?t.indexOf("!"):-1;return n>-1&&(e=t.substring(0,n),t=t.substring(n+1,t.length)),[e,t]}function a(t){return t?l(t):[]}function p(t){return function(){return m&&m.config&&m.config[t]||{}}}var h,d,y,v,b={},w={},m={},g={},_=Object.prototype.hasOwnProperty,O=[].slice,j=/\.js$/;y=function(t,e){var n,i=l(t),r=i[0],s=e[1];return t=i[1],r&&(r=o(r,s),n=f(r)),r?t=n&&n.normalize?n.normalize(t,u(s)):o(t,s):(t=o(t,s),i=l(t),r=i[0],t=i[1],r&&(n=f(r))),{f:r?r+"!"+t:t,n:t,pr:r,p:n}},v={require:function(t){return s(t)},exports:function(t){var e=b[t];return void 0!==e?e:b[t]={}},module:function(t){return{id:t,uri:"",exports:b[t],config:p(t)}}},h=function(e,n,i,o){var u,l,p,h,d,m,_,O=[],j=typeof i;if(o=o||e,m=a(o),"undefined"===j||"function"===j){for(n=!n.length&&i.length?["require","exports","module"]:n,d=0;d<n.length;d+=1)if(h=y(n[d],m),"require"===(l=h.f))O[d]=v.require(e);else if("exports"===l)O[d]=v.exports(e),_=!0;else if("module"===l)u=O[d]=v.module(e);else if(r(b,l)||r(w,l)||r(g,l))O[d]=f(l);else{if(!h.p)throw new Error(e+" missing "+l);h.p.load(h.n,s(o,!0),c(l),{}),O[d]=b[l]}p=i?i.apply(b[e],O):void 0,e&&(u&&u.exports!==t&&u.exports!==b[e]?b[e]=u.exports:p===t&&_||(b[e]=p))}else e&&(b[e]=i)},e=n=d=function(e,n,i,r,o){if("string"==typeof e)return v[e]?v[e](n):f(y(e,a(n)).f);if(!e.splice){if(m=e,m.deps&&d(m.deps,m.callback),!n)return;n.splice?(e=n,n=i,i=null):e=t}return n=n||function(){},"function"==typeof i&&(i=r,r=o),r?h(t,e,n,i):setTimeout(function(){h(t,e,n,i)},4),d},d.config=function(t){return d(t)},e._defined=b,i=function(t,e,n){if("string"!=typeof t)throw new Error("See almond README: incorrect module build, no module name");e.splice||(n=e,e=[]),r(b,t)||r(w,t)||(w[t]=[t,e,n])},i.amd={jQuery:!0}}(),i("node_modules/almond/almond",function(){}),i("nbd/Class",[],function(){"use strict";function t(t,e){return function(){return t.apply(this,arguments),e.apply(this,arguments)}}var e,n,i,r,o=/xyz/.test(function(){return xyz})?/\b_super\b/:/.*/;return n=function(e,s){function u(){"function"==typeof this.init&&this.init.apply(this,arguments)}var c,f,l,a=this.prototype;c=Object.create(a);for(f in e)e.hasOwnProperty(f)&&(l="init"===f&&!(s&&s.hasOwnProperty("_")&&s._),c[f]="function"==typeof e[f]&&"function"==typeof a[f]&&(l||o.test(e[f]))?function(t,e,n){var i=function(){return a[t].apply(this,arguments)};return function(){var t=this.hasOwnProperty("_super"),r=this._super;this._super=i;try{return n&&this._super.apply(this,arguments),e.apply(this,arguments)}catch(t){throw t}finally{t&&(this._super=r)}}}(f,e[f],l):e[f]);for(f in this)this.hasOwnProperty(f)&&(u[f]=this[f]);for(f in s)s.hasOwnProperty(f)&&(l="init"===f&&!(s&&s.hasOwnProperty("_")&&s._),u[f]=l&&"function"==typeof u[f]&&"function"==typeof s[f]?t(u[f],s[f]):s[f]);return u.prototype=c,Object.defineProperty(u.prototype,"constructor",{value:u}),Object.defineProperties(u,{extend:{value:n,enumerable:!1},mixin:{value:i},inherits:{value:r}}),u},i=function(t){var e={};return Object.keys(t).forEach(function(n){e[n]={configurable:!1,value:t[n]}}),Object.defineProperties(this.prototype,e),this},r=function(t){var e,n=!1;if("function"==typeof t)return t.prototype.isPrototypeOf(this.prototype);if("object"==typeof t){n=!0;for(e in t)if(t.hasOwnProperty(e)&&t[e]!==this.prototype[e]){n=!1;break}}return n},e=function(){},e.extend=n,e}),i("nbd/util/async",[],function(){"use strict";function t(t){n.push(t),postMessage(i,"*")}function e(t){if(t.source===window&&t.data===i&&(t.stopPropagation(),n.length>0)){n.shift()()}}var n=[],i="async-message",r="function"==typeof postMessage&&"function"==typeof addEventListener;return r&&addEventListener("message",e,!0),r?t:function(t){setTimeout(t,0)}}),i("nbd/util/extend",[],function(){"use strict";return function(t){var e,n,i;for(e=1;e<arguments.length;++e){i=arguments[e];for(n in i)t[n]=i[n]}return t}}),i("nbd/util/diff",["./extend"],function(t){"use strict";function e(t,i){var r,o=!0;if(Object.getPrototypeOf(t)!==Object.prototype||Object.getPrototypeOf(i)!==Object.prototype)return!1;for(r in t){if(t[r]!==i[r])return!1;if(t.hasOwnProperty(r)&&"object"==typeof t[r]&&t[r]&&Object.getPrototypeOf(t[r])===Object.prototype){if(~n.indexOf(t[r]))continue;try{n.push(t[r]),o=o&&e(i[r],t[r])}catch(t){}finally{n.pop()}}if(!o)return o}return o}var n=[];return function(n,i,r){var o,s,u,c={};if("object"!=typeof i||"object"!=typeof n||null===i||null===n)throw new TypeError("Arguments must be objects");i=t({},i);for(o in n)if(n.hasOwnProperty(o)){if(s=n[o],u=i[o],delete i[o],s===u)continue;"object"==typeof s&&"object"==typeof u&&s&&u&&e(s,u)||(c[o]=[s,u],r&&r.apply(this,[o,s,u]))}for(o in i)i.hasOwnProperty(o)&&void 0!==i[o]&&(c[o]=[n[o]],r&&r.apply(this,[o,void 0,i[o]]));return c}}),i("nbd/trait/pubsub",[],function(){"use strict";var t=/\s+/,e=function t(e){return t.i=t.i||0,(e||"")+ ++t.i};return{on:function(e,n,i){var r,o,s;if(!n)return this;for(e=e.split(t),this._callbacks||Object.defineProperty(this,"_callbacks",{configurable:!0,value:{},writable:!0}),r=this._callbacks;o=e.shift();)s=r[o]||(r[o]=[]),s.push(n,i);return this},off:function(e,n,i){var r,o,s,u;if(!(o=this._callbacks))return this;if(!(e||n||i))return delete this._callbacks,this;for(e=e?e.split(t):Object.keys(o);r=e.shift();)if((s=o[r])&&(n||i))for(u=s.length-2;u>=0;u-=2)n&&s[u]!==n||i&&s[u+1]!==i||s.splice(u,2);else delete o[r];return this},trigger:function(e){var n,i,r,o,s,u,c,f;if(!(i=this._callbacks))return this;for(f=[],e=e.split(t),o=1,s=arguments.length;o<s;o++)f[o-1]=arguments[o];for(;n=e.shift();){if((c=i.all)&&(c=c.slice()),(r=i[n])&&(r=r.slice()),r)for(o=0,s=r.length;o<s;o+=2)r[o].apply(r[o+1]||this,f);if(c)for(u=[n].concat(f),o=0,s=c.length;o<s;o+=2)c[o].apply(c[o+1]||this,u)}return this},listenTo:function(t,n,i){return(this._listeners||(this._listeners={}))[t._listenerId||(t._listenerId=e("l"))]=t,t.on(n,i||this,this),this},stopListening:function(t,e,n){var i=this._listeners;if(i){if(t)t.off(e,n,this),e||n||delete i[t._listenerId];else{for(var r in i)i[r].off(null,null,this);this._listeners={}}return this}}}}),i("nbd/Model",["./Class","./util/async","./util/extend","./util/diff","./trait/pubsub"],function(t,e,n,i,r){"use strict";var o=function(t,e){this._dirty&&(i.call(this,e||this._data,t,this.trigger),this._dirty=0)},s=t.extend({init:function(t,e){"string"==typeof t&&t.match(/^\d+$/)&&(t=+t),void 0===e&&"object"==typeof t&&(e=t),this.id=function(){return t};try{Object.defineProperty(this,"_dirty",{value:0,writable:!0}),Object.defineProperty(this,"_data",{enumerable:!1,configurable:!0,value:e||{},writable:!0})}catch(t){this._dirty=0,this._data=e}},destroy:function(){this.off()},data:function(){return this._dirty++||e(o.bind(this,n({},this._data))),this._data},get:function(t){return this._data[t]},set:function(t,e){var n,i=this.data();if("string"==typeof t)return i[t]=e,this;if("object"==typeof t){for(n in t)t.hasOwnProperty(n)&&(i[n]=t[n]);return this}},toJSON:function(){return this._data}}).mixin(r);return s}),i("nbd/View",["./Class","./trait/pubsub"],function(t,e){"use strict";var n=t.extend({$view:null,render:function(t){var e=this.$view;return this.trigger("prerender"),this.$view=this.template(t||this.templateData()),e&&e.length&&e.replaceWith(this.$view),this.trigger("postrender",this.$view),this.rendered&&this.rendered(this.$view),this.$view},template:function(){},templateData:function(){return{}},destroy:function(){this.$view&&this.$view.remove&&this.$view.remove(),this.$view=null,this.off()}}).mixin(e);return n}),i("nbd/View/Entity",["../View"],function(t){"use strict";var e=t.extend({init:function(t){"object"==typeof t&&(this._model=this.Model=t),this.id=t&&t.id||function(){return t}},destroy:function(t){this._model.off(null,null,this),t||(this._model=this.Model=null),this._super()},templateData:function(){return this._model&&this._model.data?this._model.data():this.id()},render:function(t){var e=this.$view,n=!(e&&t);return n&&(this.trigger("prerender"),this.$view=this.template(this.templateData())),t?this.$view&&this.$view.appendTo(t):e&&e.replaceWith(this.$view),n&&(this.trigger("postrender",this.$view),"function"==typeof this.rendered&&this.rendered(this.$view)),this.$view}});return e}),i("nbd/View/Element",["../View"],function(t){"use strict";var e=t.extend({$parent:null,init:function(t){this.$parent=t},render:function(t){var e=this.$view;return this.trigger("prerender"),this.$view=this.template(t||this.templateData()),e&&e.length?e.replaceWith(this.$view):this.$view.appendTo(this.$parent),this.trigger("postrender",this.$view),this.rendered&&this.rendered(this.$view),this.$view}});return e}),i("nbd/util/construct",[],function(){"use strict";var t=Object.prototype.toString;return function(){if(!(t.call(this).indexOf("Function")+1))throw new TypeError("construct called on incompatible Object");var e=Object.create(this.prototype),n=this.apply(e,arguments);return Object(n)===n?n:e}}),i("nbd/Controller",["./Class","./View","./util/construct"],function(t,e,n){"use strict";var i=t.extend({View:null,destroy:function(){},_initView:function(t){var e=Array.prototype.slice.call(arguments,1);(this._view=this.View=n.apply(t,e)).Controller=this},switchView:function(){var t=this._view;this._initView.apply(this,arguments),t&&(t.$view&&(this._view.$view=t.$view,this._view.render()),t.destroy())}});return i}),i("nbd/Controller/Entity",["../util/construct","../Controller","../View/Entity","../Model"],function(t,e,n,i){"use strict";var r=e.extend({Model:null,init:function(){this.Model=t.apply(this.constructor.MODEL_CLASS,arguments),this._initView(this.constructor.VIEW_CLASS,this.Model)},render:function(t,e){e=e||this.constructor.VIEW_CLASS,this.requestView(e),this.View.render(t)},destroy:function(){this.View.destroy(),this.Model.destroy(),this.Model=this.View=null},requestView:function(t){this.View instanceof t||this.switchView(t,this.Model)}},{VIEW_CLASS:n,MODEL_CLASS:i});return r}),i("nbd/event",["./util/extend","./trait/pubsub"],function(t,e){"use strict";var n=t({},e);return n.bind=n.on,n.unbind=n.off,n.fire=n.trigger,n}),i("nbd/trait/promise",["../util/async","../util/extend"],function(t,e){"use strict";function n(){function e(e){e.length&&t(function(){for(var t=0;t<e.length;++t)e[t](u)}),f=l=[]}function i(t){a||(a=1,u=t,e(f))}function r(t){a||(a=-1,u=t,e(l))}function o(t){if(t===c)throw new TypeError("Cannot resolve with self");if(t instanceof n)return void t.then(o,r);try{if(("object"==typeof t||"function"==typeof t)&&null!==t&&"function"==typeof t.then)return function(){var e=!1;try{t.then(function(n){e||(t===n?i(t):o(n),e=!0)},function(t){e||(r(t),e=!0)})}catch(t){e||r(t)}}()}catch(t){return void r(t)}i(t)}function s(e,i){function r(t){return function(e){var n;try{n=t(e)}catch(t){o.reject(t)}o.resolve(n)}}var o=new n;if(a){var s=a>0?e:i;"function"==typeof s?(s=r(s),t(function(){s(u)})):o[a>0?"resolve":"reject"](u)}else f.push("function"==typeof e?r(e):o.resolve),l.push("function"==typeof i?r(i):o.reject);return o}var u,c=this,f=[],l=[],a=0;Object.defineProperties(this,{reject:{value:r},resolve:{value:o}}),this.then=s}n.prototype.thenable=function(){return{then:this.then}},n.prototype.promise=function(){var t=this.then,e=function(){return n},n={done:function(){return Array.prototype.concat.apply([],arguments).forEach(function(e){t(e)}),n},fail:function(){return Array.prototype.concat.apply([],arguments).forEach(function(e){t(void 0,e)}),n},then:t,progress:e,promise:e};return n};var i=function(){this._promise||Object.defineProperty(this,"_promise",{value:new n})};return e(n,{then:function(t,e){return i.call(this),this._promise.then(t,e)},resolve:function(t){return i.call(this),this._promise.resolve(t),this},reject:function(t){return i.call(this),this._promise.reject(t),this},thenable:function(){return i.call(this),this._promise.thenable()},promise:function(){return i.call(this),this._promise.promise()}}),n}),i("nbd/util/deparam",[],function(){"use strict";return function(t,e){var n={},i={true:!0,false:!1,null:null};return t.replace(/\+/g," ").split("&").forEach(function(t){var r,o=t.split("="),s=decodeURIComponent(o[0]),u=n,c=0,f=s.split("]["),l=f.length-1;if(/\[/.test(f[0])&&/\]$/.test(f[l])?(f[l]=f[l].replace(/\]$/,""),f=f.shift().split("[").concat(f),l=f.length-1):l=0,2===o.length)if(r=decodeURIComponent(o[1]),e&&(r=r&&!isNaN(r)?+r:"undefined"===r?void 0:void 0!==i[r]?i[r]:r),l)for(c;c<=l;c++)s=""===f[c]?u.length:f[c],u=u[s]=c<l?u[s]||(f[c+1]&&isNaN(f[c+1])?{}:[]):r;else Array.isArray(n[s])?n[s].push(r):void 0!==n[s]?n[s]=[n[s],r]:n[s]=r;else s&&(n[s]=e?void 0:"")}),n}}),i("nbd/util/media",["./extend","../trait/pubsub"],function(t,e){"use strict";function n(t,e){var n=u(e);s[t]=n,n.addListener(o.bind(n,t)),n.matches&&o.call(n,t)}function i(t){return s[t]&&s[t].matches}function r(t,e){var i;if(!u)throw new Error("Media queries not supported.");if("string"==typeof t)return n(t,e),r;if("object"==typeof t)for(i in t)t.hasOwnProperty(i)&&(e=t[i],n(i,e));return r}var o,s={},u="undefined"!=typeof matchMedia?matchMedia:"undefined"!=typeof msMatchMedia?msMatchMedia:null;return t(r,e),o=function(t){r.trigger(t+(this.matches?":enter":":exit")),r.trigger(t,this.matches)},r.is=i,r.getState=function(t){return t?i(t):Object.keys(s).filter(i)},r}),i("nbd/util/pipe",[],function(){"use strict";return function(){var t=arguments;return function(){var e,n;for(e=0;e<t.length;++e)n=t[e].apply(this,0===e?arguments:[n]);return n}}}),i("nbd/util/protochain",[],function(){"use strict";function t(e,n){var i,r;(r=Object.getPrototypeOf(e))!==Object.prototype&&(t(r,n),n=r.constructor.prototype),i=Object.create(n);for(r in e)e.hasOwnProperty(r)&&(i[r]=e[r]);i.constructor=e.constructor,e.constructor.prototype=i}return function(e,n,i){if(arguments.length<2)throw new TypeError("Not enough arguments");if("function"!=typeof e)throw new TypeError("First argument must be a constructor");if("function"!=typeof n)throw new TypeError("Second argument must be a constructor");for(var r,o=e.prototype;(r=Object.getPrototypeOf(o))!==Object.prototype;)o=r;if(!0!==i){if(o.__proto__)return void(o.__proto__=n.prototype);throw new Error("Cannot modify prototype chain")}t(e.prototype,n.prototype)}}),i("build/all",["nbd/Class","nbd/Model","nbd/View","nbd/View/Entity","nbd/View/Element","nbd/Controller","nbd/Controller/Entity","nbd/event","nbd/trait/promise","nbd/trait/pubsub","nbd/util/async","nbd/util/construct","nbd/util/deparam","nbd/util/diff","nbd/util/extend","nbd/util/media","nbd/util/pipe","nbd/util/protochain"],function(t,e,n,i,r,o,s,u,c,f,l,a,p,h,d,y,v,b){"use strict";var w={Class:t,Model:e,View:n,Controller:o,event:u,trait:{promise:c,pubsub:f},util:{async:l,construct:a,deparam:p,diff:h,extend:d,media:y,pipe:v,protochain:b}};return w.View.Element=r,w.View.Entity=i,w.Controller.Entity=s,w}),t.nbd=n("build/all")}(this);